<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.12.0">
<title>Personal Counter</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight.3268c726.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight.3268c726.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="modulepreload" href="./_observablehq/client.e7afcba6.js">
<link rel="modulepreload" href="./_observablehq/runtime.8eb97cbb.js">
<link rel="modulepreload" href="./_observablehq/stdlib.8048ec16.js">
<link rel="modulepreload" href="./_import/scripts/main.27f6ce10.js">
<link rel="modulepreload" href="./_import/scripts/hours.a56e52f6.js">
<link rel="modulepreload" href="./_import/scripts/matrix.1296b0c8.js">
<link rel="modulepreload" href="./_import/scripts/titles.b9af6070.js">
<link rel="modulepreload" href="./_import/scripts/part.time.9e38a8d7.js">
<link rel="modulepreload" href="./_import/scripts/effective.base.51d05698.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.9d076414.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.16/e828d8c8.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/063eb405.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/c68fbd73.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/7055d4c5.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/a62ae5ce.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e95f898e.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/d44feff9.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/5830b12a.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/84d7b8e9.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/2c0cdfa2.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/626bedc4.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/00c41b5d.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/b5f7cdc6.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/b22c5864.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/407f7a1f.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/6f15f633.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/ef1ec490.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e1ff060.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/5851d7ef.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/dcd02767.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/f1db2593.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/034b7bcb.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/4bb53638.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/bbafde58.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/aa5b35a8.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/32c7fec2.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/567840a0.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/cf9b720b.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/5dcd62f4.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/f8e03c56.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/5bc129e1.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/19c92b44.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/f31b5398.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/8debb4ba.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/4b0cc581.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/1ee6c50d.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/5eed35fd.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/e67acb27.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/8ac9039b.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.e7afcba6.js";

define({id: "34b69ffd", outputs: ["version"], body: () => {
const version =  'v1.0.3'
return {version};
}});

define({id: "5ca4f385", mode: "inline", inputs: ["version","display"], body: async (version,display) => {
display(await(
version
))
}});

define({id: "a77b92ca", inputs: ["view","Inputs"], outputs: ["hrs_base"], body: (view,Inputs) => {
const hrs_base = view(Inputs.radio(new Map([
    ['<= 29', 1756],
    ['30-39', 1732],
    ['>= 40', 1700],
    ])))

return {hrs_base};
}});

define({id: "9dedcae2", outputs: ["divideHours","addHours","buildData","titles","minPartTime","updateBase"], body: async () => {
const [{default: divideHours}, {default: addHours}, {default: buildData}, {default: titles}, {default: minPartTime}, {default: updateBase}] = await Promise.all([import("./_import/scripts/main.27f6ce10.js"), import("./_import/scripts/hours.a56e52f6.js"), import("./_import/scripts/matrix.1296b0c8.js"), import("./_import/scripts/titles.b9af6070.js"), import("./_import/scripts/part.time.9e38a8d7.js"), import("./_import/scripts/effective.base.51d05698.js")]);

return {divideHours,addHours,buildData,titles,minPartTime,updateBase};
}});

define({id: "ef951e9f", inputs: ["view","Inputs","titles","hrs_base"], outputs: ["seltitle"], body: (view,Inputs,titles,hrs_base) => {
var seltitle = view(Inputs.radio(new Map(titles),
{disabled : hrs_base == null, width: 500
}))
return {seltitle};
}});

define({id: "5a7bfc09", inputs: ["seltitle"], outputs: ["notitle","title"], body: (seltitle) => {
const notitle = {'base':0.2, "research": 0.4, "teaching": 0.4}
const title = seltitle != null ? seltitle  : notitle
return {notitle,title};
}});

define({id: "b6bc50f7", inputs: ["minPartTime","title","hrs_base","view","Inputs","notitle"], outputs: ["min_percent","deltid"], body: (minPartTime,title,hrs_base,view,Inputs,notitle) => {
const min_percent = minPartTime(title, hrs_base)
const deltid = view(Inputs.range([min_percent, 100],
  {
    'step': 1,
      disabled : title == notitle,
    width: 500,
    value: 100
    }))
return {min_percent,deltid};
}});

define({id: "3c0b9f4f", inputs: ["deltid","display"], body: async (deltid,display) => {
display(await(
deltid
))
}});

define({id: "9dd55965", inputs: ["updateBase","title","hrs_base","deltid","notitle"], outputs: ["updated_title","max_research_percent"], body: (updateBase,title,hrs_base,deltid,notitle) => {
const updated_title = updateBase(title, hrs_base, deltid)
const max_research_percent = title == notitle ? 1 - title['base'] - 0.2 : (deltid*0.8)/100 - title['base']
return {updated_title,max_research_percent};
}});

define({id: "c7ba026c", inputs: ["view","Inputs","max_research_percent","title","notitle"], outputs: ["bidrag"], body: (view,Inputs,max_research_percent,title,notitle) => {
const bidrag = view(Inputs.range([0, Math.round(max_research_percent * 100) +1],
  {
    'step': 1,
    disabled : title == notitle,
    width: 500
    }))
return {bidrag};
}});

define({id: "1c397390", inputs: ["hrs_base","deltid"], outputs: ["hrs"], body: (hrs_base,deltid) => {
const hrs = hrs_base * deltid / 100
return {hrs};
}});

define({id: "8f18fd5e", inputs: ["divideHours","updated_title","bidrag","deltid"], outputs: ["basep","teachp","re_othp","re_bidrag"], body: (divideHours,updated_title,bidrag,deltid) => {
const [
  basep,
  teachp,
  re_othp,
  re_bidrag,
] = divideHours(updated_title, bidrag, deltid)
return {basep,teachp,re_othp,re_bidrag};
}});

define({id: "df57c250", inputs: ["addHours","buildData","basep","teachp","re_othp","re_bidrag","hrs"], outputs: ["data"], body: (addHours,buildData,basep,teachp,re_othp,re_bidrag,hrs) => {
const data = addHours(buildData (
  basep,
  teachp,
  re_othp,
  re_bidrag,
), hrs)
return {data};
}});

define({id: "ab3f5921", inputs: ["re_bidrag","display"], body: async (re_bidrag,display) => {
display(await(
re_bidrag
))
}});

define({id: "7895b723", inputs: ["data","hrs"], outputs: ["totp","total","tott","re_allp","re_allt"], body: (data,hrs) => {
const totp = data.reduce((a, b) => (a + b.percent), 0)
const total = totp / 100
const tott = Math.round(total * hrs)

const re_allp = data[3].percent + data[2].percent
const re_allt = data[3].hours + data[2].hours

return {totp,total,tott,re_allp,re_allt};
}});

define({id: "e8aaa3a3", mode: "inline", inputs: ["resize","Plot","data","display"], body: async (resize,Plot,data,display) => {
display(await(
    resize((width) => Plot.plot({
      height: Math.max(100, width/10),
      width: width,
      color: { legend: true, scheme: "Dark2"},
      marks: [
        Plot.barX(data, {
          x: 'percent', fill: "name"}),
      ]
    }))
  
))
}});

define({id: "701f20e0", inputs: ["title","notitle","display","data","re_allp","re_allt","totp","tott"], body: (title,notitle,display,data,re_allp,re_allt,totp,tott) => {
if (title !== notitle) {
display(
  `\nÖvrig tid:    ${data[0]['percent']}% (${data[0]['hours']} h)\nUndervisning: ${data[1]['percent']}% (${data[1]['hours']} h)\nForskning:    ${re_allp}% (${re_allt} h)\n    Varav bidrag:    ${data[3]['percent']}% (${data[3]['hours']} h)\n    Varav Fakultet*: ${data[2]['percent']}% (${data[2]['hours']} h)\n\nTotal: ${totp}% (${tott} h)`
)}
}});

define({id: "e3345720", outputs: ["toggleDivVisibility"], body: () => {
function toggleDivVisibility(div_id, display_var) {
  var div = document.getElementById(div_id)

  if (display_var == null || display_var == 0) {
    div.style.visibility = 'hidden';
  } else {
    div.style.visibility = 'visible';
  }
}

return {toggleDivVisibility};
}});

define({id: "bddfab69", inputs: ["toggleDivVisibility","hrs","data","tott"], body: (toggleDivVisibility,hrs,data,tott) => {
//| echo: false

toggleDivVisibility('hrs', hrs)

toggleDivVisibility('other', data[0]['hours'])

toggleDivVisibility('teach', data[1]['hours'])

toggleDivVisibility('research', tott)

}});

define({id: "192e2e6a", mode: "inline", inputs: ["hrs","display"], body: async (hrs,display) => {
display(await(
Math.max(0, hrs).toLocaleString("sv-SE")
))
}});

define({id: "38e1575d", mode: "inline", inputs: ["data","display"], body: async (data,display) => {
display(await(
Math.max(0, data[0]['percent']).toLocaleString("sv-SE")
))
}});

define({id: "169b7d75", mode: "inline", inputs: ["data","display"], body: async (data,display) => {
display(await(
Math.max(0, data[0]['hours']).toLocaleString("sv-SE")
))
}});

define({id: "9a8659d5", mode: "inline", inputs: ["data","display"], body: async (data,display) => {
display(await(
Math.max(0, data[1]['percent']).toLocaleString("sv-SE")
))
}});

define({id: "1514e89a", mode: "inline", inputs: ["data","display"], body: async (data,display) => {
display(await(
Math.max(0, data[1]['hours']).toLocaleString("sv-SE")
))
}});

define({id: "cbbcaefa", mode: "inline", inputs: ["re_allp","display"], body: async (re_allp,display) => {
display(await(
Math.max(0, re_allp).toLocaleString("sv-SE")
))
}});

define({id: "6a9837cd", mode: "inline", inputs: ["re_allt","display"], body: async (re_allt,display) => {
display(await(
Math.max(0, re_allt).toLocaleString("sv-SE")
))
}});

</script>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div class="observablehq observablehq--block"><!--:34b69ffd:--></div>
<div style="float: right"><observablehq-loading></observablehq-loading><!--:5ca4f385:--></div>
<h2>Beräkningsverktyg</h2>
<!-- Text? -->
<h5>1. Hur gammal är du?</h5>
<div class="observablehq observablehq--block"><!--:a77b92ca:--></div>
<h5>2. Vilken anställningsform har du?</h5>
<div class="observablehq observablehq--block"><!--:9dedcae2:--></div>
<div class="observablehq observablehq--block"><!--:ef951e9f:--></div>
<div class="observablehq observablehq--block"><!--:5a7bfc09:--></div>
<h5>3. Hur stor omfattning har din anställning?</h5>
<div class="observablehq observablehq--block"><!--:b6bc50f7:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:3c0b9f4f:--></div>
<div class="observablehq observablehq--block"><!--:9dd55965:--></div>
<h5>4. Hur stor andel bidragsfinansierad forskning har du?</h5>
<div class="observablehq observablehq--block"><!--:c7ba026c:--></div>
<div class="observablehq observablehq--block"><!--:1c397390:--></div>
<div class="observablehq observablehq--block"><!--:8f18fd5e:--></div>
<div class="observablehq observablehq--block"><!--:df57c250:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:ab3f5921:--></div>
<div class="observablehq observablehq--block"><!--:7895b723:--></div>
<div class="grid grid-cols-1">
  <div class="card"><observablehq-loading></observablehq-loading><!--:e8aaa3a3:--></div>
</div>
<h4>  Summering i procent och timmar </h4>
<div class="observablehq observablehq--block"><!--:701f20e0:--></div>
<style>

.hero {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: var(--sans-serif);
  margin: 4rem 0 8rem;
  text-wrap: balance;
  text-align: center;
}

.hero h1 {
  margin: 1rem 0;
  padding: 1rem 0;
  max-width: none;
  font-size: 14vw;
  font-weight: 900;
  line-height: 1;
  background: linear-gradient(30deg, var(--theme-foreground-focus), currentColor);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero h2 {
  margin: 0;
  max-width: 34em;
  font-size: 20px;
  font-style: initial;
  font-weight: 500;
  line-height: 1.5;
  color: var(--theme-foreground-muted);
}

@media (min-width: 640px) {
  .hero h1 {
    font-size: 90px;
  }
}

</style>
<div class="observablehq observablehq--block"><!--:e3345720:--></div>
<div class="observablehq observablehq--block"><!--:bddfab69:--></div>
<div class="grid grid-cols-4 gap-4">
  </div>
  <div class="card" id="hrs">
    <h2>Timmar</h2>
    <span class="big"><observablehq-loading></observablehq-loading><!--:192e2e6a:--></span>
  </div>
  <div class="card" id="other">
    <h2>Övrig tid (<observablehq-loading></observablehq-loading><!--:38e1575d:--> %)</h2>
    <span class="big"><observablehq-loading></observablehq-loading><!--:169b7d75:--></span>
  </div>
  <div class="card" id="teach">
    <h2>Undervisning (<observablehq-loading></observablehq-loading><!--:9a8659d5:--> %)</h2>
    <span class="big"><observablehq-loading></observablehq-loading><!--:1514e89a:--></span>
  </div>
  <div class="card" id="research">
    <h2>Forskning* (<observablehq-loading></observablehq-loading><!--:cbbcaefa:--> %)</h2>
    <span class="big"><observablehq-loading></observablehq-loading><!--:6a9837cd:--></span>
  </div>

<p>* För adjunkter avses kompetensutveckling</p>
</main>
<footer id="observablehq-footer">
<div><div style="float: left">© 2024 Mathias Johansson &amp; Institutionen för kulturvetenskaper, Lunds universitet</div><div style="float: right"> Built with observable</div><div style="margin: 0 auto; width: 100px;"><a href="https://github.com/mathjoha/Kultur_Personalplaneraren/issues/new" target="_blank" rel="noopener noreferrer">Report Issue</a><a></a></div></div>
</footer>
</div>
